<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="个人技术博客">
<meta property="og:type" content="website">
<meta property="og:title" content="CHEN.星~博客">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="CHEN.星~博客">
<meta property="og:description" content="个人技术博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CHEN.星~博客">
<meta name="twitter:description" content="个人技术博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>CHEN.星~博客</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">CHEN.星~博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">生命在于折腾</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/03/webpack配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN.星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CHEN.星~博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/03/webpack配置/" itemprop="url">webpack配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-03T10:29:43+08:00">
                2017-11-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="步骤一"><a href="#步骤一" class="headerlink" title="步骤一"></a>步骤一</h3><pre><code>//npm init -y 初始化 创建package.json
//npm install jquery --save
//npm install webpack --save-dev
</code></pre><h3 id="步骤二-创建入口js"><a href="#步骤二-创建入口js" class="headerlink" title="步骤二 创建入口js"></a>步骤二 创建入口js</h3><pre><code>路径：webpack-your-bags/src/index.js
var $ = require(&apos;jquery&apos;);
$(&apos;body&apos;).html(&apos;Hello&apos;);
</code></pre><h3 id="步骤三-创建webpack-config-js"><a href="#步骤三-创建webpack-config-js" class="headerlink" title="步骤三  创建webpack.config.js"></a>步骤三  创建webpack.config.js</h3><pre><code>var path = require(&quot;path&quot;);//用于处理目录的对象，提高开发效率（__dirname需要引入path后才可以使用）
var ROOT_PATH = path.resolve(__dirname);//获取当前整个模块文件所在目录的完整绝对路径
var BUILDS_PATH = path.resolve(ROOT_PATH, &quot;builds&quot;);//获取我们的builds目录完整绝对路径
module.exports = {
    entry: &apos;./src&apos;,
    output: {
        path: BUILDS_PATH,
        filename: &apos;bundle.js&apos;,
    },
};
</code></pre><h3 id="步骤四-创建index-html"><a href="#步骤四-创建index-html" class="headerlink" title="步骤四  创建index.html"></a>步骤四  创建index.html</h3><pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;webpack&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;script src=&quot;builds/bundle.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><h3 id="步骤五-执行webpack"><a href="#步骤五-执行webpack" class="headerlink" title="步骤五  执行webpack"></a>步骤五  执行webpack</h3><pre><code>Hash: 911040ab8380b2e9bb62
Version: webpack 3.8.1
Time: 365ms
    Asset    Size  Chunks                    Chunk Names
bundle.js  271 kB       0  [emitted]  [big]  main
   [0] ./src/index.js 105 bytes {0} [built]
    + 1 hidden module
    +
//看到生成./src/index.js

这里webpack会告诉你bundle.js包含了我们的入口点(index.js)和一个隐藏的模块，这个隐藏的模块就是jquery，默认情况下webpack会把第三方模块给隐藏掉，如果想要看见webpack编译的所有的模块 ，我们可以加 --display-modules 参数
//webpack --display-modules
E:\webpack-your-bags&gt;webpack --display-modules
Hash: 911040ab8380b2e9bb62
Version: webpack 3.8.1
Time: 315ms
    Asset    Size  Chunks                    Chunk Names
bundle.js  271 kB       0  [emitted]  [big]  main
   [0] ./src/index.js 105 bytes {0} [built]
   [1] ./node_modules/jquery/dist/jquery.js 268 kB {0} [built]

~~如果你觉得每次修改都要重新执行webpack太麻烦，你也可以运行 webpack --watch 来自动监视文件的变化，如果文件有发生变化，便会自动重新编译。
</code></pre><h3 id="loader配置"><a href="#loader配置" class="headerlink" title="loader配置"></a>loader配置</h3><blockquote>
<ul>
<li>$ npm install babel-loader –save-dev<br> //babel-core这个包和它的预设 es2015</li>
<li>$ npm install babel-core babel-preset-es2015 –save-dev</li>
<li>创建 .babelrc 文件,路径：webpack-your-bags/.babelrc//{“presets”: [“es2015”] }</li>
<li>index.jsES6写法import $ from ‘jquery’;$(‘body’).html(‘Hello’);</li>
</ul>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/02/angulrjs3级联动/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN.星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CHEN.星~博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/02/angulrjs3级联动/" itemprop="url">angulrjs3级联动</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-02T11:54:47+08:00">
                2017-11-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="3级联动写法一"><a href="#3级联动写法一" class="headerlink" title="3级联动写法一"></a>3级联动写法一</h3><pre><code>//html
 &lt;label &gt;
    &lt;select ng-model=&quot;selected&quot; ng-options=&quot;s.gcName for s in list&quot; ng-change=&quot;levelOne()&quot; class=&quot;form-control validate[required,maxSize[255]]&quot;&gt;
        &lt;option value=&quot;&quot;&gt;--请选择--&lt;/option&gt;
    &lt;/select&gt;
&lt;/label&gt;
&lt;label &gt;
    &lt;select ng-model=&quot;selected2&quot; ng-options=&quot;sh.gcName for sh in selected.items&quot; ng-change=&quot;levelTwo()&quot; class=&quot;form-control validate[required,maxSize[255]]&quot;&gt;
        &lt;option value=&quot;&quot;&gt;--请选择--&lt;/option&gt;
    &lt;/select&gt;
&lt;/label&gt;
&lt;label  &gt;
    &lt;select ng-model=&quot;selected3&quot; ng-options=&quot;x.gcName for x in selected2.items&quot; ng-change=&quot;levelThree()&quot; class=&quot;form-control validate[required,maxSize[255]]&quot;&gt;
        &lt;option value=&quot;&quot;&gt;--请选择--&lt;/option&gt;
      &lt;/select&gt;
 &lt;/label&gt;
//js
$scope.levelOne = function () {

     $scope.selected2 = &quot;&quot;;
     $scope.selected3 = &quot;&quot;;
};

$scope.levelTwo = function () {

        $scope.selected3 = &quot;&quot;;
     };

$scope.levelThree = function () {

     };
</code></pre><h3 id="3级联动写法二：显影控制"><a href="#3级联动写法二：显影控制" class="headerlink" title="3级联动写法二：显影控制"></a>3级联动写法二：显影控制</h3><pre><code>//html
  &lt;label ng-class=&quot;{error: error.levelOne}&quot;&gt;
        &lt;select ng-model=&quot;selected&quot; ng-options=&quot;s.gcName for s in list&quot; ng-change=&quot;levelOne()&quot; class=&quot;form-control validate[required,maxSize[255]]&quot;&gt;
            &lt;option value=&quot;&quot;&gt;--请选择--&lt;/option&gt;
        &lt;/select&gt;
&lt;/label&gt;
&lt;label ng-show=&quot;selected.items.length&quot; ng-class=&quot;{error: error.levelTwo}&quot;&gt;
        &lt;select ng-model=&quot;selected2&quot; ng-options=&quot;sh.gcName for sh in selected.items&quot; ng-change=&quot;levelTwo()&quot; class=&quot;form-control validate[required,maxSize[255]]&quot;&gt;
            &lt;option value=&quot;&quot;&gt;--请选择--&lt;/option&gt;
        &lt;/select&gt;
&lt;/label&gt;
&lt;label ng-show=&quot;selected2.items.length&quot; ng-class=&quot;{error: error.levelThree}&quot;&gt;
        &lt;select ng-model=&quot;selected3&quot; ng-options=&quot;x.gcName for x in selected2.items&quot; ng-change=&quot;levelThree()&quot; class=&quot;form-control validate[required,maxSize[255]]&quot;&gt;
            &lt;option value=&quot;&quot;&gt;--请选择--&lt;/option&gt;
          &lt;/select&gt;
 &lt;/label&gt;
    //js
    $scope.levelOne = function () {
            $scope.error.levelOne = false;
             $scope.error.levelTwo = false;
             $scope.error.levelThree = false;
             $scope.selected2 = &quot;&quot;;
             $scope.selected3 = &quot;&quot;;
        };

    $scope.levelTwo = function () {
            $scope.error.levelTwo = false;
            $scope.error.levelThree = false;
            $scope.selected3 = &quot;&quot;;
         };

    $scope.levelThree = function () {
        $scope.error.levelOne = false;
         };
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/25/convas压缩图片上传/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN.星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CHEN.星~博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/25/convas压缩图片上传/" itemprop="url">移动端convas压缩图片上传</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-25T16:09:39+08:00">
                2017-10-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>var filechooser = document.getElementById(&quot;choose&quot;);
        //用于压缩图片的canvas
        var canvas = document.createElement(&quot;canvas&quot;);
        var ctx = canvas.getContext(&apos;2d&apos;);
        //瓦片canvas
        var tCanvas = document.createElement(&quot;canvas&quot;);
        var tctx = tCanvas.getContext(&quot;2d&quot;);
        var maxsize = 100 * 1024;
        var blobArray=[];

 $(&quot;#fileUpload&quot;).on(&quot;click&quot;, function() {
                filechooser.click();
            })
            .on(&quot;touchstart&quot;, function() {
                $(this).addClass(&quot;touch&quot;)
            })
            .on(&quot;touchend&quot;, function() {
                $(this).removeClass(&quot;touch&quot;)
            });
 $scope.picturesNumber=0;
    filechooser.onchange = function() {
        if (!this.files.length) return;
        var files = Array.prototype.slice.call(this.files);
        var imgs=$(&quot;.img-list&quot;).find(&quot;li&quot;).length;
        if (imgs &gt; 4) {
            alert(&quot;最多同时只可上传5张图片&quot;);
            return;
        }
        $scope.$apply(function(){
                $scope.picturesNumber=imgs
            }
        )
        files.forEach(function(file, i) {
            if (!/\/(?:jpeg|png|gif)/i.test(file.type)) return;
            var reader = new FileReader();
            var li = document.createElement(&quot;li&quot;);
            li.className = &apos;img-list-img-li&apos;;
            //获取图片大小
            var size = file.size / 1024 &gt; 1024 ? (~~(10 * file.size / 1024 / 1024)) / 10 + &quot;MB&quot; : ~~(file.size / 1024) + &quot;KB&quot;;
            li.innerHTML = &apos; &lt;img class=&quot;img-list-img&quot; src=&quot;img/repair/close.png&quot; alt=&quot;&quot;&gt;&apos;;
            $(&quot;.img-list&quot;).prepend($(li));
            reader.onload = function() {
                var result = this.result;
                var img = new Image();
                img.src = result;
                $(li).css(&quot;background-image&quot;, &quot;url(&quot; + result + &quot;)&quot;);
                //点中哪张就删除哪张
                $(li).on(&quot;click&quot;,&quot;img&quot;,function(){
                    $(this).parent().remove();
                    $scope.$apply(function(){
                            $scope.picturesNumber=$(&quot;.img-list&quot;).find(&quot;li&quot;).length-1
                        }
                    );
                });
                //如果图片大小小于100kb，则直接上传
                if (result.length &lt;= maxsize) {
                    img = null;
                    upload(result,file.type,$(li),file.name);
                    return;
                }
                //图片加载完毕之后进行压缩，然后上传
                if (img.complete) {

                    callback();
                } else {
                    img.onload = callback;
                }
                function callback() {
                    var data = compress(img);
                    upload(data,file.type,$(li),file.name);
                    img = null;
                }
            };
            reader.readAsDataURL(file);
        })
    };
     //使用canvas对大图片进行压缩
        function compress(img) {
            var initSize = img.src.length;
            var width = img.width;
            var height = img.height;
            //如果图片大于四百万像素，计算压缩比并将大小压至400万以下
            var ratio;
            if ((ratio = width * height / 4000000) &gt; 1) {
                ratio = Math.sqrt(ratio);
                width /= ratio;
                height /= ratio;
            } else {
                ratio = 1;
            }
            canvas.width = width;
            canvas.height = height;
            //铺底色
            ctx.fillStyle = &quot;#fff&quot;;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            //如果图片像素大于100万则使用瓦片绘制
            var count;
            if ((count = width * height / 1000000) &gt; 1) {
                count = ~~(Math.sqrt(count) + 1); //计算要分成多少块瓦片
                //计算每块瓦片的宽和高
                var nw = ~~(width / count);
                var nh = ~~(height / count);
                tCanvas.width = nw;
                tCanvas.height = nh;
                for (var i = 0; i &lt; count; i++) {
                    for (var j = 0; j &lt; count; j++) {
                        tctx.drawImage(img, i * nw * ratio, j * nh * ratio, nw * ratio, nh * ratio, 0, 0, nw, nh);
                        ctx.drawImage(tCanvas, i * nw, j * nh, nw, nh);
                    }
                }
            } else {
                ctx.drawImage(img, 0, 0, width, height);
            }
            //进行最小压缩
            var ndata = canvas.toDataURL(&apos;image/jpeg&apos;, 0.1);
            tCanvas.width = tCanvas.height = canvas.width = canvas.height = 0;
            return ndata;
        }
        //图片上传，将base64的图片转成二进制对象，塞进formdata上传
        function upload(basestr,type,$li,fileName) {
            var text = window.atob(basestr.split(&quot;,&quot;)[1]);
            var buffer = new Uint8Array(text.length);
            var pecent = 0, loop = null;
            for (var i = 0; i &lt; text.length; i++) {
                buffer[i] = text.charCodeAt(i);
            }
            var blob = getBlob([buffer],type,fileName);
            blobArray.push({blob:blob,fileName:fileName});
        }

        /**
         * 获取blob对象的兼容性写法
         * @param buffer
         * @param format
         * @returns {*}
         */
        function getBlob(buffer,format,name) {
            try {
                return new Blob(buffer,{type:format,name:name});
            } catch (e) {
                var bb = new (window.BlobBuilder || window.WebKitBlobBuilder || window.MSBlobBuilder);
                buffer.forEach(function(buf) {
                    bb.append(buf);
                });
                return bb.getBlob(format);
            }
        }

        /**
         * 获取formdata
         */
        function getFormData() {
            var isNeedShim = ~navigator.userAgent.indexOf(&apos;Android&apos;)
                &amp;&amp; ~navigator.vendor.indexOf(&apos;Google&apos;)
                &amp;&amp; !~navigator.userAgent.indexOf(&apos;Chrome&apos;)
                &amp;&amp; navigator.userAgent.match(/AppleWebKit\/(\d+)/).pop() &lt;= 534;
            return isNeedShim ? new FormDataShim() : new FormData()
        }

        /**
         * formdata 补丁, 给不支持formdata上传blob的android机打补丁
         * @constructor
         */
        function FormDataShim() {
            var o = this,
                parts = [],
                boundary = Array(21).join(&apos;-&apos;) + (+new Date() * (1e16 * Math.random())).toString(36),
                oldSend = XMLHttpRequest.prototype.send;
            this.append = function(name, value, filename) {
                parts.push(&apos;--&apos; + boundary + &apos;\r\nContent-Disposition: form-data; name=&quot;&apos; + name + &apos;&quot;&apos;);
                if (value instanceof Blob) {
                    parts.push(&apos;; filename=&quot;&apos; + (filename || &apos;blob&apos;) + &apos;&quot;\r\nContent-Type: &apos; + value.type + &apos;\r\n\r\n&apos;);
                    parts.push(value);
                }
                else {
                    parts.push(&apos;\r\n\r\n&apos; + value);
                }
                parts.push(&apos;\r\n&apos;);
            };
            // Override XHR send()
            XMLHttpRequest.prototype.send = function(val) {
                var fr,
                    data,
                    oXHR = this;
                if (val === o) {
                    // Append the final boundary string
                    parts.push(&apos;--&apos; + boundary + &apos;--\r\n&apos;);
                    // Create the blob
                    data = getBlob(parts);
                    // Set up and read the blob into an array to be sent
                    fr = new FileReader();
                    fr.onload = function() {
                        oldSend.call(oXHR, fr.result);
                    };
                    fr.onerror = function(err) {
                        throw err;
                    };
                    fr.readAsArrayBuffer(data);
                    // Set the multipart content type and boudary
                    this.setRequestHeader(&apos;Content-Type&apos;, &apos;multipart/form-data; boundary=&apos; + boundary);
                    XMLHttpRequest.prototype.send = oldSend;
                }
                else {
                    oldSend.call(this, val);
                }
            };
        }
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/25/百度地图获取地理信息/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN.星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CHEN.星~博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/25/百度地图获取地理信息/" itemprop="url">百度地图获取地理信息</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-25T15:53:35+08:00">
                2017-10-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>&lt;script type=&quot;text/javascript&quot; src=&quot;http://api.map.baidu.com/api?v=2.0&amp;ak=vxGvQW5jBqiuaZmVEaZtFkSeyTP9MzPw&quot;&gt;&lt;/script&gt;

// 百度地图获取地理信息
        var longitude, latitude, province, city, district, street, streetNumber, address;
        // 创建地理编码实例
        var myGeo = new BMap.Geocoder();
        var geolocation = new BMap.Geolocation();
        geolocation.getCurrentPosition(function (r) {
            if (geolocation.getStatus() == BMAP_STATUS_SUCCESS) {
                longitude = r.point.lng;
                latitude = r.point.lat;
                // 根据坐标得到地址描述
                myGeo.getLocation(r.point, function (result) {
                    if (result) {
                        var addComp = result.addressComponents;
                        province = addComp.province;
                        city = addComp.city;
                        district = addComp.district;
                        street = addComp.street;
                        streetNumber = addComp.streetNumber;
                        address = province + city + district + street + streetNumber;
                    }
                });
            }
            else {
                alert(&apos;failed&apos; + this.getStatus());
            }
        }, {enableHighAccuracy: true});
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/25/css3背景旋转/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN.星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CHEN.星~博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/25/css3背景旋转/" itemprop="url">css3背景旋转</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-25T14:25:00+08:00">
                2017-10-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>很久没写css3效果了，生疏了，放一段css3背景旋转</p>
<pre><code> css---
  #audio_btn {
         width: 30px;
         height: 30px;
         background-image: url(img/audio.png);
         background-size: contain;
     }

.rotate {
        -webkit-animation: rotating 1.2s linear infinite;
         -moz-animation: rotating 1.2s linear infinite;
         -o-animation: rotating 1.2s linear infinite;
          animation: rotating 1.2s linear infinite
      }

  @-webkit-keyframes rotating {
     from { -webkit-transform: rotate(0deg) }
    to { -webkit-transform: rotate(360deg) }
 }

@keyframes rotating {
    from { transform: rotate(0deg) }
     to { transform: rotate(360deg) }
  }
 @-moz-keyframes rotating {
   from { -moz-transform: rotate(0deg) }
   to { -moz-transform: rotate(360deg) }
}
</code></pre><hr>
<pre><code>js--
 $(function(){
 var x = document.getElementById(&quot;media&quot;);
 $(&quot;#audio_btn&quot;).click(function(){
        $(this).toggleClass(&quot;rotate&quot;); //控制音乐图标 自转或暂停

          //控制背景音乐 播放或暂停
        if($(this).hasClass(&quot;rotate&quot;)){
                 x.play();
               }else{
                x.pause();
              }
       })
   });
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/23/消息推送notification/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN.星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CHEN.星~博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/23/消息推送notification/" itemprop="url">消息推送</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-23T10:51:23+08:00">
                2017-10-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h3><pre><code>//Notification API
// 先检查浏览器是否支持
    if (!(&quot;Notification&quot; in window)) {
        alert(&quot;This browser does not support desktop notification&quot;);
    }
    // 检查用户是否同意接受通知
    else if (Notification.permission === &quot;granted&quot;) {
        // If it&apos;s okay let&apos;s create a notification
        var notification = new Notification(&quot;Hi there!&quot;);
    }
    // 否则我们需要向用户获取权限
    else if (Notification.permission !== &apos;denied&apos;) {
        Notification.requestPermission(function (permission) {
            // 如果用户同意，就可以向他们发送通知
            if (permission === &quot;granted&quot;) {
                var notification = new Notification(&quot;Hi there!&quot;);
            }
        });
    }    
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/04/base64字符数据图片转Blob/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN.星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CHEN.星~博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/04/base64字符数据图片转Blob/" itemprop="url">base64字符数据图片转Blob以及上传遇到问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-04T20:19:07+08:00">
                2017-05-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>项目存在一个图片过大做压缩的功能，而遇到blob字符转换遇到的一些问题记录，以及上传出现的问题。</li>
</ul>
<hr>
<h3 id="base64转换blob"><a href="#base64转换blob" class="headerlink" title="base64转换blob"></a>base64转换blob</h3><pre><code>/**
 * 将以base64的图片url数据转换为Blob
 * @param urlData
 *  用url方式表示的base64图片数据
 */
function convertBase64UrlToBlob(urlData){
        var bytes=window.atob(urlData.split(&apos;,&apos;)[1]);        //去掉url的头，并转换为byte
        //处理异常,将ascii码小于0的转换为大于0
        var arr = urlData.split(&apos;,&apos;);
        var mime = arr[0].match(/:(.*?);/)[1];//获取到图片类型
        console.log(mime);
        var ab = new ArrayBuffer(bytes.length);
        var ia = new Uint8Array(ab);
        for (var i = 0; i &lt; bytes.length; i++) {
            ia[i] = bytes.charCodeAt(i);
        }
        return new Blob( [ab] , {type : mime});}
</code></pre><hr>
<h3 id="压缩图片JS"><a href="#压缩图片JS" class="headerlink" title="压缩图片JS"></a>压缩图片JS</h3><pre><code>  * 这是基于html5的前端图片工具，压缩工具。

 function ImageResizer(opts,returnObject){  
 var settings={
    resizeMode:&quot;auto&quot;//压缩模式，总共有三种  auto,width,height auto表示自动根据最大的宽度及高度等比压缩，width表示只根据宽度来判断是否需要等比例压缩，height类似。
    ,dataSource:&quot;&quot; //数据源。数据源是指需要压缩的数据源，有三种类型，image图片元素，base64字符串，canvas对象，还有选择文件时候的file对象。。。
    ,dataSourceType:&quot;image&quot; //image  base64 canvas
    //,maxWidth:150 //允许的最大宽度
    //,maxHeight:200 //允许的最大高度。
    ,onTmpImgGenerate:function(img){} //当中间图片生成时候的执行方法。。这个时候请不要乱修改这图片，否则会打乱压缩后的结果。
    ,success:function(resizeImgBase64,canvas){

    }//压缩成功后图片的base64字符串数据。
    ,debug:false //是否开启调试模式。
};
var appData={};
$.extend(settings,opts);

var _debug=function(str,styles){
    if(settings.debug==true){
        if(styles){
            console.log(str,styles);
        }
        else{
            console.log(str);
        }
    }
};
var innerTools={
    getBase4FromImgFile:function(file,callBack){

        var reader = new FileReader();
        reader.onload = function(e) {
            var base64Img= e.target.result;
            //var $img = $(&apos;&lt;img&gt;&apos;).attr(&quot;src&quot;, e.target.result)
            //$(&apos;#preview&apos;).empty().append($img)
            if(callBack){
                callBack(base64Img);
            }
        };
        reader.readAsDataURL(file);
    }

    //--处理数据源。。。。将所有数据源都处理成为图片图片对象，方便处理。
    ,getImgFromDataSource:function(datasource,dataSourceType,callback){
        var _me=this;
        var img1=new Image();
        if(dataSourceType==&quot;img&quot;||dataSourceType==&quot;image&quot;){
            img1.src=$(datasource).attr(&quot;src&quot;);
            if(callback){
                callback(img1);
            }
        }
        else if(dataSourceType==&quot;base64&quot;){
            img1.src=datasource;
            if(callback){
                callback(img1);
            }            }
        else if(dataSourceType==&quot;canvas&quot;){
            img1.src = datasource.toDataURL(&quot;image/jpeg&quot;);
            if(callback){
                callback(img1);
            }
        }
        else if(dataSourceType==&quot;file&quot;){
            _me.getBase4FromImgFile(function(base64str){
                img1.src=base64str;
                if(callback){
                    callback(img1);
                }
            });
        }

    }
    //计算图片的需要压缩的尺寸。当然，压缩模式，压缩限制直接从setting里面取出来。
    ,getResizeSizeFromImg:function(img){
        var _img_info={
            w:$(img)[0].naturalWidth,
            h:$(img)[0].naturalHeight
        };
        console.log(&quot;真实尺寸：&quot;);
        console.log(_img_info);
        var _resize_info={
            w:0
            ,h:0
        };
        if(_img_info.w&lt;=settings.maxWidth&amp;&amp;_img_info.h&lt;=settings.maxHeight){
            return _img_info;
        }
        if(settings.resizeMode==&quot;auto&quot;){
            var _percent_scale=parseFloat(_img_info.w/_img_info.h);
            var _size1={
                w:0
                ,h:0
            };
            var _size_by_mw={
                w:settings.maxWidth
                ,h:parseInt(settings.maxWidth/_percent_scale)
            };
            var _size_by_mh={
                w:parseInt(settings.maxHeight*_percent_scale)
                ,h:settings.maxHeight
            };
            if(_size_by_mw.h&lt;=settings.maxHeight){
                return _size_by_mw;
            }
            if(_size_by_mh.w&lt;=settings.maxWidth){
                return _size_by_mh;
            }

            return {
                w:settings.maxWidth
                ,h:settings.maxHeight
            };

        }
        if(settings.resizeMode==&quot;width&quot;){
            if(_img_info.w&lt;=settings.maxWidth){
                return _img_info;
            }
            var _size_by_mw={
                w:settings.maxWidth
                ,h:parseInt(settings.maxWidth/_percent_scale)
            };
            return _size_by_mw;
        }

        if(settings.resizeMode==&quot;height&quot;){
            if(_img_info.h&lt;=settings.maxHeight){
                return _img_info;
            }
            var _size_by_mh={
                w:parseInt(settings.maxHeight*_percent_scale)
                ,h:settings.maxHeight
            };
            return _size_by_mh;
        }

    }
    //--将相关图片对象画到canvas里面去。
    ,drawToCanvas:function(img,theW,theH,realW,realH,callback){

        var canvas = document.createElement(&quot;canvas&quot;);
        canvas.width=theW;
        canvas.height=theH;
        var ctx = canvas.getContext(&apos;2d&apos;);
        ctx.drawImage(img,
            0,//sourceX,
            0,//sourceY,
            realW,//sourceWidth,
            realH,//sourceHeight,
            0,//destX,
            0,//destY,
            theW,//destWidth,
            theH//destHeight
        );

        //--获取base64字符串及canvas对象传给success函数。
        var base64str=canvas.toDataURL(&quot;image/png&quot;);
        if(callback){
            callback(base64str,canvas);
        }
    }
};

//--开始处理。
(function(){
    innerTools.getImgFromDataSource(settings.dataSource,settings.dataSourceType,function(_tmp_img){
        var __tmpImg=_tmp_img;
        settings.onTmpImgGenerate(_tmp_img);
        //--计算尺寸。
        var _limitSizeInfo=innerTools.getResizeSizeFromImg(__tmpImg);
        console.log(_limitSizeInfo);
        var _img_info={
            w:$(__tmpImg)[0].naturalWidth,
            h:$(__tmpImg)[0].naturalHeight
        };
        innerTools.drawToCanvas(__tmpImg,_limitSizeInfo.w,_limitSizeInfo.h,_img_info.w,_img_info.h,function(base64str,canvas){
            settings.success(base64str,canvas);
        });

    });
})();

returnObject({
    a:1
});

//return returnObject;
</code></pre><p>};</p>
<h3 id="blob上传遇到的问题"><a href="#blob上传遇到的问题" class="headerlink" title="blob上传遇到的问题"></a>blob上传遇到的问题</h3><pre><code>    /**
    *File对象为base
    /
  var img = new FormData();
img.append(&quot;files&quot;, eachFile,eachFile.name);
</code></pre><ul>
<li>项目后台代码反正我不清楚，平时上传的图片是存在图片名字的，base64在转为Blob后上传，获取不到文件名字，就需要eachFile.name作为参数一起append到文件流里面。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/10/JqueryFileUpload遇到angulrjs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN.星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CHEN.星~博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/10/JqueryFileUpload遇到angulrjs/" itemprop="url">JqueryFileUpload遇到angulrjs</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-10T20:11:00+08:00">
                2017-04-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>input上传单个文件的时候，点击多次替换文件，文件会缓存起来，clone,replaceWith这个input会解决此问题，但是angularjs替换input元素后不会认识这个dom元素，事件不会执行，需要用到$compile指令来封装一次元素。</li>
</ul>
<hr>
<pre><code>var input=$(&quot;#imgFile&quot;);
 var template = angular.element(input.clone());//复制一个input
 var content = $compile(template)(scope);用angularjs 封装好
 input.replaceWith(content); 替换
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/15/angulrjs项目拦截器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN.星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CHEN.星~博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/15/angulrjs项目拦截器/" itemprop="url">angulrjs项目拦截器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-15T10:59:24+08:00">
                2017-03-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="项目中拦截器"><a href="#项目中拦截器" class="headerlink" title="项目中拦截器"></a>项目中拦截器</h3><pre><code>(function(angular){
&apos;use strict&apos;;
angular.module(&quot;platform.main.interceptor&quot;,[])
    /**
     * 服务端消息状态码处理   
     */
    .factory(&apos;messageHttpInterceptor&apos;,[&apos;$q&apos;,function($q){
        return {
            &apos;response&apos;: function(response) {
                var result = response.data;
                if(result.text &amp;&amp; result.text!=&quot;&quot;){
                    if(result.code&gt;=0){
                        toastr.success(result.text);
                    }else{
                        if(result.code==14013){
                            window.location.href =&quot;index.html&quot;;
                        }else {
                            toastr.error(result.text);
                        }

                    }
                }
                return response;
            }
        }
    }])
    .config([&apos;$httpProvider&apos;,function($httpProvider){
        $httpProvider.interceptors.push(&apos;messageHttpInterceptor&apos;);
    }])
})(angular);
——————————

(function(angular){
&apos;use strict&apos;;
angular.module(&quot;platform.main.interceptor&quot;,[])
    /**
     * 服务端消息状态码处理
     */
    .factory(&apos;messageHttpInterceptor&apos;,[&apos;$q&apos;,function($q){
        return {
             request:function(config){
                  config.headers[&quot;TOKEN&quot;] = $rootScope.user.token;
                  return config;

                },
            &apos;response&apos;: function(response) {
                var result = response.data;
                if(result.text &amp;&amp; result.text!=&quot;&quot;){
                    if(result.code&gt;=0){
                        toastr.success(result.text);
                    }else{
                        if(result.code==14013){
                            window.location.href =&quot;index.html&quot;;
                        }else {
                            toastr.error(result.text);
                        }

                    }
                }
                return response;
            }，
             responseError: function (response) {
                  var data = response.data;
                  // 判断错误码，如果是未登录
                  if(data[&quot;errorCode&quot;] == &quot;500999&quot;){
                    // 清空用户本地token存储的信息，如果
                    $rootScope.user = {token:&quot;&quot;};
                    // 全局事件，方便其他view获取该事件，并给以相应的提示或处理
                    $rootScope.$emit(&quot;userIntercepted&quot;,&quot;notLogin&quot;,response);
                  }
                  // 如果是登录超时
                  if(data[&quot;errorCode&quot;] == &quot;500998&quot;){
                    $rootScope.$emit(&quot;userIntercepted&quot;,&quot;sessionOut&quot;,response);
                  }
                  return $q.reject(response);
                }
        }
    }])
    .config([&apos;$httpProvider&apos;,function($httpProvider){
        $httpProvider.interceptors.push(&apos;messageHttpInterceptor&apos;);
    }])
})(angular);
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/15/angulrjs中run的运用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN.星">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CHEN.星~博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/15/angulrjs中run的运用/" itemprop="url">angulrjs中run的运用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-15T19:59:35+08:00">
                2017-02-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="run方法用于初始化全局的数据，仅对全局作用域起作用。"><a href="#run方法用于初始化全局的数据，仅对全局作用域起作用。" class="headerlink" title="run方法用于初始化全局的数据，仅对全局作用域起作用。"></a>run方法用于初始化全局的数据，仅对全局作用域起作用。</h1><h3 id="浏览器判断"><a href="#浏览器判断" class="headerlink" title="浏览器判断"></a>浏览器判断</h3><pre><code>.run([&apos;$rootScope&apos;, &apos;$route&apos;, &apos;$window&apos;, &apos;$location&apos;, &apos;Position&apos;, &apos;$cookies&apos;, &apos;Request&apos;, &apos;$cookieStore&apos;,
  function($rootScope, $route, $window, $location, position, $cookies, request, $cookieStore) {
   //非微信的登陆
   $rootScope.isWeiXinLogin = function() {
//判断是否微信登陆
var ua = window.navigator.userAgent.toLowerCase();
//console.log(ua); //mozilla/5.0 (iphone; cpu iphone os 9_1 like mac os x) applewebkit/601.1.46 (khtml, like gecko) version/9.0 mobile/13b143 safari/601.1
if (ua.match(/MicroMessenger/i) == &apos;micromessenger&apos;) {
 console.log(&quot; 是来自微信内置浏览器&quot;);
 return true;
} else {
 console.log(&quot;不是来自微信内置浏览器&quot;);
 return false;
}
   };
]);
--------------
控制层处理
angular.module(&apos;autumnswind&apos;).controller(&apos;OrderCtrl&apos;, [&apos;$rootScope&apos;, &apos;$scope&apos;, &apos;Request&apos;, &apos;$cookies&apos;, &apos;$window&apos;, &apos;$routeParams&apos;, &apos;$location&apos;, &apos;Tool&apos;,
 function($rootScope, $scope, request, $cookies, $window, $routeParams, $location, tool) { 
if ($rootScope.isWeiXinLogin()) {
     ...
    }
   }
]);
</code></pre><h3 id="登陆判断"><a href="#登陆判断" class="headerlink" title="登陆判断"></a>登陆判断</h3><h4 id="项目中run-http和ajax请求头全局"><a href="#项目中run-http和ajax请求头全局" class="headerlink" title="项目中run$http和ajax请求头全局"></a>项目中run$http和ajax请求头全局</h4><pre><code>.run([&apos;$http&apos;, &apos;$cookies&apos;,&apos;$rootScope&apos;,&apos;$location&apos;, function($http, $cookies,$rootScope,$location) {
        $http.defaults.headers.common[&apos;X-Requested-With&apos;] = &apos;XMLHttpRequest&apos;;
        $http.defaults.headers.common[&apos;X-Auth-Token&apos;] = $cookies.get(&apos;X-Auth-Token&apos;);
        $.ajaxSetup({
            headers: {
                &apos;X-Auth-Token&apos;: $cookies.get(&apos;X-Auth-Token&apos;)
            }
        });

    }]);
    //x-requested-with XMLHttpRequest是Ajax 异步请求方式
    //直接用于全局环境每次$http头信息
</code></pre><h3 id="什么是-XMLHttpRequest-对象？"><a href="#什么是-XMLHttpRequest-对象？" class="headerlink" title="什么是 XMLHttpRequest 对象？"></a>什么是 XMLHttpRequest 对象？</h3><ul>
<li>XMLHttpRequest 对象用于在后台与服务器交换数据。</li>
<li>XMLHttpRequest 对象是开发者的梦想，因为您能够：</li>
<li>在不重新加载页面的情况下更新网页<br>在页面已加载后从服务器请求数据<br>在页面已加载后从服务器接收数据<br>在后台向服务器发送数据</li>
<li>所有现代的浏览……</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="CHEN.星" />
          <p class="site-author-name" itemprop="name">CHEN.星</p>
           
              <p class="site-description motion-element" itemprop="description">个人技术博客</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">40</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CHEN.星</span>
</div>


<div class="powered-by">
   个人专属
</div>

<div class="theme-info">
  博客 -CHEN.星
  
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
